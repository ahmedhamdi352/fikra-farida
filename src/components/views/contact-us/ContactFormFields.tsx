'use client';

import { useTranslations } from 'next-intl';
import { useForm } from 'react-hook-form';
import { yupResolver } from '@hookform/resolvers/yup';
import { useContactUsMutation } from 'hooks';
import { PhoneInput } from 'components/forms/phone-input'
import * as yup from 'yup';
import TextInput from '../../forms/text-input';
import TextArea from '../../forms/text-area'; // Import TextArea component
import { useSiteData } from 'context/SiteContext';

interface ContactFormData {
  fullName: string;
  email: string;
  phone: string;
  message: string;
  company?: string;
  employeesNumber?: number;
}

const schema = yup.object().shape({
  fullName: yup.string().required('Full name is required').min(2, 'Name must be at least 2 characters'),
  email: yup.string().required('Email is required').email('Invalid email format'),
  phone: yup.string().required('Phone number is required'),
  company: yup.string().optional(),
  employeesNumber: yup.number().optional(),
  message: yup.string().required('Message is required').min(10, 'Message must be at least 10 characters'),
});

export default function ContactFormFields() {
  const t = useTranslations('contact');
  const { isLoading, onContactUs } = useContactUsMutation();
  const siteData = useSiteData();
  const {
    control,
    handleSubmit,
  } = useForm<ContactFormData>({
    resolver: yupResolver(schema),
    mode: 'onBlur'
  });

  const onSubmit = async (data: ContactFormData) => {
    onContactUs({
      token: process.env.NEXT_PUBLIC_EMAIL_TOKEN as string,
      to: 'contact@fikrafarida.com',
      subject: `${data.fullName} | From Firka Farida Contact us`,
      body: `My phone number: ${data.phone}
               My Email: ${data.email}
               My company: ${data.company}
               Number Of Employees: ${data.employeesNumber}
               My message: ${data.message}`,
    })
  };

  return (
    <form noValidate onSubmit={handleSubmit(onSubmit)} className="flex flex-col gap-3 sm:gap-4 lg:gap-6 w-full">
      <TextInput
        control={control}
        name="fullName"
        placeholder={t('form.fullName')}
        icon={
          <svg width="24" height="24" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="account_circle">
              <path id="icon" d="M3.90016 11.3997C4.46683 10.9663 5.10016 10.6247 5.80016 10.3747C6.50016 10.1247 7.2335 9.99967 8.00016 9.99967C8.76683 9.99967 9.50016 10.1247 10.2002 10.3747C10.9002 10.6247 11.5335 10.9663 12.1002 11.3997C12.4891 10.9441 12.7918 10.4275 13.0085 9.84968C13.2252 9.2719 13.3335 8.65523 13.3335 7.99967C13.3335 6.5219 12.8141 5.26356 11.7752 4.22467C10.7363 3.18579 9.47794 2.66634 8.00016 2.66634C6.52239 2.66634 5.26405 3.18579 4.22516 4.22467C3.18627 5.26356 2.66683 6.5219 2.66683 7.99967C2.66683 8.65523 2.77516 9.2719 2.99183 9.84968C3.2085 10.4275 3.51127 10.9441 3.90016 11.3997ZM8.00016 8.66634C7.34461 8.66634 6.79183 8.44134 6.34183 7.99134C5.89183 7.54134 5.66683 6.98856 5.66683 6.33301C5.66683 5.67745 5.89183 5.12467 6.34183 4.67467C6.79183 4.22467 7.34461 3.99967 8.00016 3.99967C8.65572 3.99967 9.2085 4.22467 9.6585 4.67467C10.1085 5.12467 10.3335 5.67745 10.3335 6.33301C10.3335 6.98856 10.1085 7.54134 9.6585 7.99134C9.2085 8.44134 8.65572 8.66634 8.00016 8.66634ZM8.00016 14.6663C7.07794 14.6663 6.21127 14.4913 5.40016 14.1413C4.58905 13.7913 3.8835 13.3163 3.2835 12.7163C2.6835 12.1163 2.2085 11.4108 1.8585 10.5997C1.5085 9.78856 1.3335 8.9219 1.3335 7.99967C1.3335 7.07745 1.5085 6.21079 1.8585 5.39967C2.2085 4.58856 2.6835 3.88301 3.2835 3.28301C3.8835 2.68301 4.58905 2.20801 5.40016 1.85801C6.21127 1.50801 7.07794 1.33301 8.00016 1.33301C8.92239 1.33301 9.78905 1.50801 10.6002 1.85801C11.4113 2.20801 12.1168 2.68301 12.7168 3.28301C13.3168 3.88301 13.7918 4.58856 14.1418 5.39967C14.4918 6.21079 14.6668 7.07745 14.6668 7.99967C14.6668 8.9219 14.4918 9.78856 14.1418 10.5997C13.7918 11.4108 13.3168 12.1163 12.7168 12.7163C12.1168 13.3163 11.4113 13.7913 10.6002 14.1413C9.78905 14.4913 8.92239 14.6663 8.00016 14.6663Z" fill="#F4DD94" />
            </g>
          </svg>

        }
      />

      <TextInput
        control={control}
        name="company"
        placeholder={t('form.company')}
        icon={
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M22.989 2.66675H9.01225C7.93897 2.66673 7.05314 2.66672 6.33155 2.72567C5.58209 2.78691 4.89315 2.91833 4.24604 3.24805C3.24251 3.75937 2.42661 4.57527 1.91528 5.5788C1.58556 6.22591 1.45414 6.91485 1.39291 7.66431C1.33395 8.3859 1.33397 9.27171 1.33398 10.345V21.6551C1.33397 22.7284 1.33395 23.6143 1.39291 24.3358C1.45414 25.0853 1.58556 25.7743 1.91528 26.4214C2.42661 27.4249 3.24251 28.2408 4.24604 28.7521C4.89315 29.0818 5.58209 29.2133 6.33155 29.2745C7.05314 29.3334 7.93894 29.3334 9.01222 29.3334H22.9891C24.0624 29.3334 24.9482 29.3334 25.6698 29.2745C26.4192 29.2133 27.1082 29.0818 27.7553 28.7521C28.7588 28.2408 29.5747 27.4249 30.086 26.4214C30.4157 25.7743 30.5472 25.0853 30.6084 24.3358C30.6673 23.6143 30.6673 22.7285 30.6673 21.6552V10.345C30.6673 9.27171 30.6673 8.3859 30.6084 7.66431C30.5472 6.91485 30.4157 6.22591 30.086 5.5788C29.5747 4.57527 28.7588 3.75937 27.7553 3.24805C27.1082 2.91833 26.4192 2.78691 25.6698 2.72567C24.9482 2.66672 24.0623 2.66673 22.989 2.66675ZM5.34209 13.2526C5.42349 12.5207 6.08277 11.9934 6.81464 12.0748C9.82322 12.4094 12.6284 13.7578 14.7689 15.8983C16.9094 18.0388 18.2578 20.844 18.5924 23.8526C18.6738 24.5844 18.1465 25.2437 17.4146 25.3251C16.6828 25.4065 16.0235 24.8792 15.9421 24.1473C15.6744 21.7405 14.5957 19.4963 12.8833 17.7839C11.1709 16.0715 8.92673 14.9928 6.51987 14.7251C5.788 14.6437 5.26069 13.9844 5.34209 13.2526ZM5.36082 18.5335C5.50797 17.812 6.21217 17.3463 6.9337 17.4935C8.47112 17.807 9.8824 18.5658 10.9919 19.6753C12.1014 20.7848 12.8601 22.1961 13.1737 23.7335C13.3208 24.455 12.8552 25.1592 12.1337 25.3064C11.4122 25.4535 10.708 24.9879 10.5608 24.2664C10.3518 23.2414 9.84596 22.3006 9.10629 21.5609C8.36662 20.8212 7.42577 20.3154 6.40082 20.1064C5.67929 19.9592 5.21366 19.255 5.36082 18.5335ZM6.66726 22.6666C5.93088 22.6666 5.33392 23.2636 5.33392 23.9999C5.33392 24.7363 5.93088 25.3333 6.66726 25.3333H6.68059C7.41697 25.3333 8.01392 24.7363 8.01392 23.9999C8.01392 23.2636 7.41697 22.6666 6.68059 22.6666H6.66726Z" fill="#F4DD94" />
          </svg>
        }
      />

      <TextInput
        control={control}
        name="employeesNumber"
        placeholder={t('form.employeesNumber')}
        icon={
          <svg width="24" height="24" viewBox="0 0 16 16" fill="none" xmlns="http://www.w3.org/2000/svg">
            <g id="gmail_groups">
              <path id="icon" d="M0 13.3337V11.4837C0 11.1059 0.0944445 10.7559 0.283333 10.4337C0.472222 10.1114 0.733333 9.86699 1.06667 9.70033C1.22222 9.62255 1.37222 9.55033 1.51667 9.48366C1.67222 9.41699 1.83333 9.35588 2 9.30033V13.3337H0ZM2.66667 8.66699C2.11111 8.66699 1.63889 8.47255 1.25 8.08366C0.861111 7.69477 0.666667 7.22255 0.666667 6.66699C0.666667 6.11144 0.861111 5.63921 1.25 5.25033C1.63889 4.86144 2.11111 4.66699 2.66667 4.66699C3.22222 4.66699 3.69444 4.86144 4.08333 5.25033C4.47222 5.63921 4.66667 6.11144 4.66667 6.66699C4.66667 7.22255 4.47222 7.69477 4.08333 8.08366C3.69444 8.47255 3.22222 8.66699 2.66667 8.66699ZM2.66667 7.33366C2.85556 7.33366 3.01111 7.27255 3.13333 7.15033C3.26667 7.01699 3.33333 6.85588 3.33333 6.66699C3.33333 6.4781 3.26667 6.32255 3.13333 6.20033C3.01111 6.06699 2.85556 6.00032 2.66667 6.00032C2.47778 6.00032 2.31667 6.06699 2.18333 6.20033C2.06111 6.32255 2 6.4781 2 6.66699C2 6.85588 2.06111 7.01699 2.18333 7.15033C2.31667 7.27255 2.47778 7.33366 2.66667 7.33366ZM2.66667 13.3337V11.467C2.66667 11.0892 2.76111 10.7448 2.95 10.4337C3.15 10.1114 3.41111 9.86699 3.73333 9.70033C4.42222 9.35588 5.12222 9.10033 5.83333 8.93366C6.54445 8.75588 7.26667 8.66699 8 8.66699C8.73333 8.66699 9.45556 8.75588 10.1667 8.93366C10.8778 9.10033 11.5778 9.35588 12.2667 9.70033C12.5889 9.86699 12.8444 10.1114 13.0333 10.4337C13.2333 10.7448 13.3333 11.0892 13.3333 11.467V13.3337H2.66667ZM4 12.0003H12V11.467C12 11.3448 11.9667 11.2337 11.9 11.1337C11.8444 11.0337 11.7667 10.9559 11.6667 10.9003C11.0667 10.6003 10.4611 10.3781 9.85 10.2337C9.23889 10.0781 8.62222 10.0003 8 10.0003C7.37778 10.0003 6.76111 10.0781 6.15 10.2337C5.53889 10.3781 4.93333 10.6003 4.33333 10.9003C4.23333 10.9559 4.15 11.0337 4.08333 11.1337C4.02778 11.2337 4 11.3448 4 11.467V12.0003ZM8 8.00033C7.26667 8.00033 6.63889 7.73921 6.11667 7.21699C5.59444 6.69477 5.33333 6.06699 5.33333 5.33366C5.33333 4.60033 5.59444 3.97255 6.11667 3.45033C6.63889 2.9281 7.26667 2.66699 8 2.66699C8.73333 2.66699 9.36111 2.9281 9.88333 3.45033C10.4056 3.97255 10.6667 4.60033 10.6667 5.33366C10.6667 6.06699 10.4056 6.69477 9.88333 7.21699C9.36111 7.73921 8.73333 8.00033 8 8.00033ZM8 6.66699C8.36667 6.66699 8.67778 6.53921 8.93333 6.28366C9.2 6.01699 9.33333 5.70033 9.33333 5.33366C9.33333 4.96699 9.2 4.65588 8.93333 4.40033C8.67778 4.13366 8.36667 4.00033 8 4.00033C7.63333 4.00033 7.31667 4.13366 7.05 4.40033C6.79445 4.65588 6.66667 4.96699 6.66667 5.33366C6.66667 5.70033 6.79445 6.01699 7.05 6.28366C7.31667 6.53921 7.63333 6.66699 8 6.66699ZM13.3333 8.66699C12.7778 8.66699 12.3056 8.47255 11.9167 8.08366C11.5278 7.69477 11.3333 7.22255 11.3333 6.66699C11.3333 6.11144 11.5278 5.63921 11.9167 5.25033C12.3056 4.86144 12.7778 4.66699 13.3333 4.66699C13.8889 4.66699 14.3611 4.86144 14.75 5.25033C15.1389 5.63921 15.3333 6.11144 15.3333 6.66699C15.3333 7.22255 15.1389 7.69477 14.75 8.08366C14.3611 8.47255 13.8889 8.66699 13.3333 8.66699ZM13.3333 7.33366C13.5222 7.33366 13.6778 7.27255 13.8 7.15033C13.9333 7.01699 14 6.85588 14 6.66699C14 6.4781 13.9333 6.32255 13.8 6.20033C13.6778 6.06699 13.5222 6.00032 13.3333 6.00032C13.1444 6.00032 12.9833 6.06699 12.85 6.20033C12.7278 6.32255 12.6667 6.4781 12.6667 6.66699C12.6667 6.85588 12.7278 7.01699 12.85 7.15033C12.9833 7.27255 13.1444 7.33366 13.3333 7.33366ZM14 13.3337V9.30033C14.1667 9.35588 14.3222 9.41699 14.4667 9.48366C14.6222 9.55033 14.7778 9.62255 14.9333 9.70033C15.2667 9.86699 15.5278 10.1114 15.7167 10.4337C15.9056 10.7559 16 11.1059 16 11.4837V13.3337H14Z" fill="#F4DD94" />
            </g>
          </svg>
        }
      />

      <TextInput
        control={control}
        name="email"
        type="email"
        placeholder={t('form.email')}
        icon={
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M16.6965 1.78189C16.2401 1.65832 15.759 1.65832 15.3026 1.78189C14.7728 1.92534 14.3267 2.27555 13.9707 2.55505L13.8712 2.63294L4.72453 9.74691C4.22235 10.1366 3.77993 10.48 3.45026 10.9257C3.16093 11.3169 2.9454 11.7575 2.81426 12.2261C2.66482 12.76 2.66542 13.32 2.66611 13.9556L2.6662 23.7848C2.66618 24.4877 2.66616 25.094 2.70696 25.5934C2.75003 26.1206 2.84512 26.6448 3.10218 27.1494C3.48567 27.902 4.09759 28.5139 4.85024 28.8974C5.35475 29.1545 5.87904 29.2496 6.40616 29.2926C6.90559 29.3334 7.51193 29.3334 8.21478 29.3334H23.7843C24.4871 29.3334 25.0935 29.3334 25.5929 29.2926C26.12 29.2496 26.6443 29.1545 27.1488 28.8974C27.9015 28.5139 28.5134 27.902 28.8969 27.1494C29.154 26.6448 29.249 26.1206 29.2921 25.5934C29.3329 25.094 29.3329 24.4877 29.3329 23.7848L29.333 13.9556C29.3336 13.32 29.3343 12.76 29.1848 12.2261C29.0537 11.7575 28.8381 11.3169 28.5488 10.9257C28.2191 10.48 27.7767 10.1366 27.2745 9.7469L18.1279 2.63294L18.0284 2.55506C17.6723 2.27555 17.2263 1.92534 16.6965 1.78189ZM12.1255 18.3344C11.9419 17.6213 11.215 17.1919 10.5019 17.3755C9.78874 17.559 9.35943 18.286 9.54298 18.9991C10.283 21.8742 12.8913 24.0001 15.9995 24.0001C19.1078 24.0001 21.7161 21.8742 22.4561 18.9991C22.6396 18.286 22.2103 17.559 21.4972 17.3755C20.7841 17.1919 20.0571 17.6213 19.8736 18.3344C19.4295 20.0599 17.8615 21.3334 15.9995 21.3334C14.1375 21.3334 12.5696 20.0599 12.1255 18.3344Z" fill="#F4DD94" />
          </svg>
        }
      />

      <PhoneInput
        name="phone"
        label="Phone Number"
        type="tel"
        control={control}
        required
        defaultCountry={siteData.code.toLocaleLowerCase() || 'eg'}
        placeholder="Enter your phone number"
      />

      <TextArea
        control={control}
        name="message"
        placeholder={t('form.message')}
        icon={
          <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 32 32" fill="none">
            <path fill-rule="evenodd" clip-rule="evenodd" d="M17.5493 13.3333H25.1187C25.8216 13.3332 26.4279 13.3332 26.9274 13.374C27.4545 13.4171 27.9788 13.5122 28.4833 13.7692C29.2359 14.1527 29.8478 14.7646 30.2313 15.5173C30.4884 16.0218 30.5835 16.5461 30.6266 17.0732C30.6674 17.5727 30.6673 18.179 30.6673 18.8819V22.595C30.6673 23.1798 30.6673 23.6845 30.6389 24.1021C30.6088 24.5419 30.5428 24.9818 30.3628 25.4164C29.9569 26.3965 29.1782 27.1752 28.198 27.5812C27.7635 27.7612 27.3236 27.8272 26.8838 27.8572C26.8141 27.8619 26.7419 27.8659 26.6673 27.8692V29.3333C26.6673 29.8297 26.3916 30.285 25.9516 30.5149C25.5117 30.7449 24.9804 30.7114 24.5729 30.428L21.671 28.4105C21.224 28.0998 21.1336 28.0431 21.0482 28.0044C20.9497 27.9598 20.8461 27.9273 20.7397 27.9077C20.6475 27.8907 20.5409 27.8856 19.9965 27.8856H17.5493C16.8464 27.8857 16.24 27.8857 15.7406 27.8449C15.2135 27.8018 14.6892 27.7067 14.1847 27.4497C13.432 27.0662 12.8201 26.4542 12.4366 25.7016C12.1796 25.1971 12.0845 24.6728 12.0414 24.1457C12.0006 23.6462 12.0006 23.0399 12.0006 22.337V18.8819C12.0006 18.179 12.0006 17.5726 12.0414 17.0732C12.0845 16.5461 12.1796 16.0218 12.4366 15.5173C12.8201 14.7646 13.432 14.1527 14.1847 13.7692C14.6892 13.5122 15.2135 13.4171 15.7406 13.374C16.24 13.3332 16.8464 13.3332 17.5493 13.3333Z" fill="#F4DD94" />
            <path d="M18.9891 1.33325H9.01229C7.93901 1.33324 7.05318 1.33322 6.33159 1.39218C5.58213 1.45341 4.89319 1.58483 4.24607 1.91455C3.24254 2.42588 2.42665 3.24177 1.91532 4.2453C1.5856 4.89242 1.45418 5.58136 1.39295 6.33082C1.33399 7.05241 1.33401 7.93823 1.33402 9.01152L1.334 15.361C1.33383 15.9499 1.33369 16.3862 1.39034 16.7729C1.73185 19.1044 3.5629 20.9354 5.89439 21.2769C5.98971 21.2909 6.04914 21.3267 6.07476 21.348L6.07476 23.4517C6.07471 23.8152 6.07466 24.1718 6.10002 24.4585C6.12254 24.7132 6.18155 25.2407 6.55638 25.6779C6.9742 26.1653 7.60059 26.4225 8.24035 26.3693C8.81426 26.3217 9.22695 25.9878 9.42193 25.8224C9.47748 25.7753 9.53501 25.7239 9.59409 25.6691C9.47066 25.1882 9.41462 24.7421 9.38363 24.3629C9.33368 23.7514 9.33385 23.045 9.334 22.3935V18.8255C9.33385 18.174 9.33368 17.4675 9.38363 16.8561C9.44018 16.1641 9.58011 15.2498 10.0606 14.3067C10.6998 13.0523 11.7197 12.0324 12.9741 11.3932C13.9172 10.9127 14.8315 10.7728 15.5235 10.7162C16.1349 10.6663 16.8413 10.6664 17.4928 10.6666H25.1752C25.6628 10.6665 26.1811 10.6664 26.6674 10.6872V9.01149C26.6674 7.93821 26.6674 7.05241 26.6084 6.33082C26.5472 5.58136 26.4158 4.89242 26.0861 4.2453C25.5747 3.24177 24.7588 2.42588 23.7553 1.91455C23.1082 1.58483 22.4193 1.45341 21.6698 1.39218C20.9482 1.33322 20.0624 1.33324 18.9891 1.33325Z" fill="#F4DD94" />
          </svg>
        }
      />

      <button
        type="submit"
        disabled={isLoading}
        className="w-full py-4 bg-[var(--main-color1)] text-white rounded-lg hover:bg-[#e08616] transition-all duration-300 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        {isLoading ? 'Submitting...' : t('form.submit')}
      </button>
    </form>
  );
}
